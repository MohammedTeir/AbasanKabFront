import{d as E,r as n,o as B,y as d,a as x,h,c as f,b as a,w as v,i as T,j as t,D as K,s as b,T as L,F,e as r,t as i,m as k,k as P,E as U}from"./index-717cf31f.js";const O={class:"flex gap-[70px] mb-[70px]"},G={class:"w-[420px] flex flex-col gap-[35px] lg:ps-[40px]"},H={class:"flex gap-[10px] justify-start mb-3 lg:mb-[50px]"},J={class:"h-[80px] w-[80px] overflow-hidden rounded-sm shrink relative"},Q=["src"],R={class:"grow text-right"},W={class:"text-[22px]"},X={class:"text-[22px] text-[#058041]"},Y={class:"underline"},Z={class:"w-[32px] h-[32px]"},tt=t("p",{class:"text-[20px]"},"إضافة عنوان شخصي",-1),et={key:0},st={class:"w-[32px] h-[32px]"},ot=t("p",{class:"text-[20px]"},"طلب رمز تفعيل جديد /كلمة مرور",-1),lt={class:"w-[32px] h-[32px]"},at=t("p",{class:"text-[20px]"},"تسجيل الخروج",-1),nt={class:"flex lg:flex-row lg:justify-between mb-8 flex-col-reverse"},rt=t("h3",{class:"text-[26px] mb-4 lg:mb-0"},"الخدمات المطلوبة من طرفك",-1),it={class:"w-full"},ct={class:"rounded-lg"},dt={class:"w-full"},ut=t("thead",null,[t("tr",null,[t("th",{class:"w-[25%] bg-gray-200 p-1 lg:p-4 rounded-tr-lg rounded-br-lg text-right lg:ps-10"}," إسم الخدمة "),t("th",{class:"w-[25%] bg-gray-200 p-1 lg:p-4"},"نوع الخدمة"),t("th",{class:"w-[25%] bg-gray-200 p-1 lg:p-4"},"تاريخ الطلب"),t("th",{class:"w-[25%] bg-gray-200 p-1 lg:p-4 rounded-tl-lg rounded-bl-lg text-left lg:pe-10"}," حالة الطلب")])],-1),pt={class:"px-2 py-2 lg:py-4 text-[18px] lg:ps-10 text-right text-[#058041]"},xt={class:"px-2 py-2 lg:py-4 text-[18px]"},ht={class:"px-2 py-2 lg:py-4 text-[18px]"},ft={class:"px-2 py-2 lg:py-4 text-[18px] lg:pe-10 text-left text-[#058041]"},gt={key:0,class:"fixed inset-0 flex items-center justify-center"},_t={class:"bg-white rounded-lg p-6 shadow-xl"},mt={class:"w-full flex"},vt={class:"mb-4"},wt=t("label",{for:"file-input",class:"block mb-2"},"Choose File:",-1),yt=t("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded-md"},"حفظ",-1),Ct=E({__name:"Profile",setup(bt){const g=n(),c=n(),V=n();B(async()=>{g.value=d().getUser});const C=n();B(async()=>{const{data:e}=await x.get("/auth/service-requests",{headers:{Authorization:`Bearer ${d().token}`,"Content-Type":"application/json"}});C.value=e.data});async function j(){const e=d();try{await x.post("/auth/logout",null,{headers:{Authorization:`Bearer ${e.token}`}}).then(()=>{e.$reset(),U.push("/")})}catch(s){console.error("Logout error:",s)}}async function z(){try{await x.post("/auth/reset-password",null,{headers:{Authorization:`Bearer ${d().token}`,"Content-Type":"application/json"}}).then(e=>{c.value=e.data.message,setTimeout(()=>{c.value=""},3e3)})}catch(e){console.log(e)}}const w=n(),_=n(!1);async function D(){try{await x.post("/auth/address",{address:w.value},{headers:{Authorization:`Bearer ${d().token}`}}).then(e=>{e.data.status==200&&(c.value=e.data.message,_.value=!1),setTimeout(()=>{c.value=""},3e3)})}catch(e){console.log(e)}}const u=n(!1),p=n();function N(e){p.value=Array.from(e.target.files)}async function q(){var s;const e=new FormData;for(let l=0;l<((s=p.value)==null?void 0:s.length);l++)e.append("avatar",p==null?void 0:p.value[l]);try{await x.post("/auth/update-profile-image",e,{headers:{Authorization:`Bearer ${d().getToken}`}}).then(l=>{console.log(l)})}catch(l){console.log(l)}}return(e,s)=>{const l=h("font-awesome-icon"),y=h("FormKit"),I=h("router-link"),M=h("base-section"),S=h("toast");return r(),f(F,null,[a(M,null,{default:v(()=>{var m,A,$;return[t("article",O,[t("div",G,[t("div",H,[t("div",J,[t("img",{class:"w-full h-full",src:(m=g.value)==null?void 0:m.image_url,alt:""},null,8,Q),a(l,{icon:"fa-solid fa-camera",onClick:s[0]||(s[0]=o=>u.value=!u.value),class:"absolute w-[20px] h-[20px] bottom-0 translate-x-[-10px] bg-black text-white p-1 rounded-full"})]),t("div",R,[t("p",W,i((A=g.value)==null?void 0:A.name),1),t("p",X,[k("رقم الهوية "),t("strong",Y,":"+i(($=g.value)==null?void 0:$.pin),1)])])]),t("div",null,[t("div",{class:"flex gap-2 items-center cursor-pointer hover:text-[#058041] hover:underline",onClick:s[1]||(s[1]=o=>_.value=!_.value)},[t("div",Z,[a(l,{icon:"fa-solid fa-user",class:"h-full w-full font-light text-[#058041]"})]),tt]),_.value?(r(),f("div",et,[a(y,{type:"form",actions:!1},{default:v(()=>[a(y,{type:"text","wrapper-class":"py-[10px] text-right","inner-class":"w-full","input-class":"text-[22px] w-full border rounded-lg text-[18px] px-3 py-4 outline-none",validation:"required",modelValue:w.value,"onUpdate:modelValue":s[2]||(s[2]=o=>w.value=o)},null,8,["modelValue"]),a(y,{type:"button","wrapper-class":"py-[10px]","input-class":"w-full text-white border-[3px] border-[#A7A465] rounded-[10px] text-center w-[320px] h-[60px] text-[20px] bg-[#A7A465]",label:"حفظ",onClick:s[3]||(s[3]=o=>D())})]),_:1})])):b("",!0)]),t("div",{class:"flex gap-2 items-center cursor-pointer hover:text-[#058041] hover:underline",onClick:s[4]||(s[4]=o=>z())},[t("div",st,[a(l,{icon:"fa-solid fa-fingerprint",class:"h-full w-full font-light text-[#058041]"})]),ot]),t("div",{class:"flex gap-2 items-center cursor-pointer hover:text-[#058041] hover:underline",onClick:j},[t("div",lt,[a(l,{icon:"fa-solid fa-arrow-right-from-bracket",class:"h-full w-full font-light text-[#058041]"})]),at])])]),t("article",null,[t("div",nt,[rt,a(I,{to:"/services",class:"py-[18px] px-[30px] rounded-md text-white bg-[#A7A465] mb-4 lg:mb-0"},{default:v(()=>[k(" طلب خدمة جديدة ")]),_:1})]),t("div",it,[t("div",ct,[t("table",dt,[ut,t("tbody",null,[(r(!0),f(F,null,P(C.value,o=>(r(),f("tr",null,[t("td",pt,i(o==null?void 0:o.service_id),1),t("td",xt,i(o==null?void 0:o.service_category_id),1),t("td",ht,i(e.$useFormattedDate(o==null?void 0:o.requested_date)),1),t("td",ft,i(o==null?void 0:o.status),1)]))),256))])])])])])]}),_:1}),(r(),T(L,{to:"body"},[u.value?(r(),f("div",gt,[t("div",_t,[t("div",mt,[t("button",{onClick:s[5]||(s[5]=m=>u.value=!u.value),class:"w-[24px] h-[24px] shrink-0"},[a(l,{icon:"fa-solid fa-xmark",class:"w-full h-full"})])]),t("form",{onSubmit:s[6]||(s[6]=K(m=>q(),["prevent"]))},[t("div",vt,[wt,t("input",{type:"file",id:"file-input",class:"w-full",onChange:N},null,32)]),yt],32)])])):b("",!0)])),c.value?(r(),T(S,{key:0,type:V.value},{default:v(()=>[k(i(c.value),1)]),_:1},8,["type"])):b("",!0)],64)}}});export{Ct as default};
